<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tic-Tac-Toe</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        :root {
            --bg-color: #000000;
            --panel-bg: rgba(255, 255, 255, 0.05);
            --border-color: rgba(255, 255, 255, 0.1);
            --cell-bg: #1e293b;
            --cell-hover-bg: #334155;
            --primary-accent: #4f46e5;
            --primary-accent-hover: #6366f1;
            --text-primary: #f8fafc;
            --text-secondary: #94a3b8;
            --glow-x: rgba(96, 165, 250, 0.5);
            --glow-o: rgba(244, 114, 182, 0.5);
        }

        @keyframes background-pan {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        @keyframes fade-in-up {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        @keyframes symbol-pop-in {
            0% { transform: scale(0.6); opacity: 0; }
            80% { transform: scale(1.1); opacity: 1; }
            100% { transform: scale(1); opacity: 1; }
        }

        body {
            font-family: 'Inter', sans-serif;
            background: var(--bg-color);
            color: var(--text-primary);
            overflow: hidden;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .main-container {
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 2rem 1rem;
            perspective: 1200px;
            box-sizing: border-box;
        }
        
        .panel {
            background: var(--panel-bg);
            border: 1px solid var(--border-color);
            border-radius: 1.5rem; /* 24px */
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            box-shadow: 0 0 50px rgba(79, 70, 229, 0.25), inset 0 0 10px rgba(255, 255, 255, 0.05);
            animation: fade-in-up 0.8s ease-out forwards;
        }
        
        #game-container {
            width: 100%;
            max-width: 420px;
            margin: auto 0;
        }
        
        .game-board-wrapper {
            position: relative;
        }

        .game-board {
            display: grid;
            grid-template-columns: repeat(3, max-content);
            gap: 1.25rem; /* 20px */
            position: relative;
            z-index: 10;
        }

        .cell {
            width: 80px;
            height: 80px;
            background-color: var(--cell-bg);
            border-radius: 1rem; /* 16px */
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            transition: background-color 0.2s ease, transform 0.2s ease;
            box-shadow: inset 0 2px 4px rgba(0,0,0,0.2);
        }
        @media (min-width: 640px) { 
            .cell {
                width: 100px;
                height: 100px;
            } 
        }

        .cell:hover:not(.x):not(.o) {
            background-color: var(--cell-hover-bg);
            transform: translateY(-4px);
        }

        .cell.x, .cell.o {
            cursor: not-allowed;
        }
        
        .cell svg {
            width: 50%;
            height: 50%;
            animation: symbol-pop-in 0.4s ease-out forwards;
        }

        .cell.x svg { box-shadow: 0 0 20px var(--glow-x); border-radius: 50%; }
        .cell.o svg { box-shadow: 0 0 20px var(--glow-o); border-radius: 50%; }

        #win-canvas {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 20;
        }

        .header {
            opacity: 0;
            animation: fade-in-up 0.6s 0.2s ease-out forwards;
        }

        .score-board {
            display: flex;
            justify-content: space-between;
            gap: 1rem;
        }
        .score-card {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            font-weight: 500;
            padding: 0.75rem 0.5rem;
            border-radius: 1rem;
            transition: all 0.3s ease;
            color: var(--text-secondary);
        }
        .score-card.active {
            color: var(--text-primary);
            transform: scale(1.05);
        }
        .score-card.x.active { background-color: rgba(59, 130, 246, 0.2); }
        .score-card.o.active { background-color: rgba(236, 72, 153, 0.2); }
        .score-label {
            font-size: 0.875rem;
        }
        .score-value { font-size: 1.875rem; line-height: 2.25rem; font-weight: 700; }
        .score-icon { width: 1.25rem; height: 1.25rem; }

        .difficulty-control {
            text-align: center;
            opacity: 0;
            animation: fade-in-up 0.6s 0.4s ease-out forwards;
        }
        .difficulty-control label {
            display: block;
            margin-bottom: 1rem;
            font-weight: 600;
            color: var(--text-secondary);
            font-size: 1.125rem;
        }
        input[type="range"] {
            -webkit-appearance: none;
            appearance: none;
            width: 100%;
            height: 8px;
            background: #334155;
            border-radius: 5px;
            outline: none;
            transition: background 0.3s ease;
        }
        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 24px;
            height: 24px;
            background: var(--primary-accent);
            cursor: pointer;
            border-radius: 50%;
            border: 4px solid var(--bg-color);
            transition: background 0.2s ease;
        }
        input[type="range"]::-webkit-slider-thumb:hover {
            background: var(--primary-accent-hover);
        }

        .modal-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(5px);
            display: flex; justify-content: center; align-items: center;
            z-index: 1000; opacity: 0; visibility: hidden;
            transition: opacity 0.3s ease, visibility 0.3s ease;
        }
        .modal-overlay.active { opacity: 1; visibility: visible; }
        .modal-content {
            transform: scale(0.9) translateY(20px); transition: transform 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            width: calc(100% - 2rem); max-width: 400px;
        }
        .modal-overlay.active .modal-content { transform: scale(1) translateY(0); }
        
        .btn {
            background-image: linear-gradient(to right, var(--primary-accent) 0%, #818cf8 51%, var(--primary-accent) 100%);
            background-size: 200% auto;
            color: white; padding: 1rem 2rem;
            border-radius: 0.75rem;
            font-weight: 700; cursor: pointer;
            transition: all 0.4s ease; border: none;
            text-transform: uppercase;
            letter-spacing: 1px;
            box-shadow: 0 4px 15px 0 rgba(79, 70, 229, 0.75);
        }
        .btn:hover {
            background-position: right center;
            transform: translateY(-2px);
            box-shadow: 0 8px 25px 0 rgba(79, 70, 229, 0.6);
        }
        .footer {
            color: var(--text-secondary);
            font-size: 0.875rem;
            text-align: center;
            width: 100%;
            opacity: 0.7;
            flex-shrink: 0;
        }
    </style>
</head>
<body>
    <div class="main-container">
        <div id="game-container" class="panel p-6 md:p-8 space-y-6">
            <header class="header text-center">
                <h1 class="text-4xl md:text-5xl font-bold tracking-tighter">Tic-Tac-Toe</h1>
            </header>
            
            <div class="difficulty-control">
                <label for="difficulty-slider" id="difficulty-label">Difficulty: Normal</label>
                <input type="range" id="difficulty-slider" min="1" max="5" value="3" step="1">
            </div>

            <div class="score-board">
                <div id="score-x" class="score-card x">
                     <span class="score-label">
                        You
                    </span>
                    <span id="score-x-value" class="score-value">0</span>
                </div>
                <div id="score-draw" class="score-card items-center">
                     <span class="score-label">Draws</span>
                    <span id="score-draw-value" class="score-value">0</span>
                </div>
                <div id="score-o" class="score-card o">
                    <span class="score-label">
                        AI
                    </span>
                    <span id="score-o-value" class="score-value">0</span>
                </div>
            </div>

            <div class="game-board-wrapper flex justify-center">
                <div id="game-board" class="game-board">
                    <!-- Cells generated by JS -->
                </div>
                <canvas id="win-canvas"></canvas>
            </div>
        </div>
        
        <footer class="footer space-y-3">
            <div class="flex justify-center items-center space-x-5">
                <a href="https://github.com/rajatkumar1011" target="_blank" rel="noopener noreferrer" class="text-gray-400 hover:text-white transition-colors">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M12 2C6.477 2 2 6.477 2 12c0 4.418 2.865 8.168 6.839 9.49.5.092.682-.217.682-.482 0-.237-.009-.868-.014-1.703-2.782.605-3.369-1.343-3.369-1.343-.454-1.158-1.11-1.466-1.11-1.466-.908-.62.069-.608.069-.608 1.003.07 1.531 1.032 1.531 1.032.892 1.53 2.341 1.088 2.91.832.092-.647.35-1.088.636-1.338-2.22-.253-4.555-1.113-4.555-4.951 0-1.093.39-1.988 1.031-2.688-.103-.253-.446-1.272.098-2.65 0 0 .84-.27 2.75 1.026A9.564 9.564 0 0112 6.844c.85.004 1.705.115 2.504.337 1.909-1.296 2.747-1.027 2.747-1.027.546 1.379.203 2.398.1 2.651.64.7 1.03 1.595 1.03 2.688 0 3.848-2.338 4.695-4.566 4.943.359.309.678.92.678 1.855 0 1.338-.012 2.419-.012 2.747 0 .268.18.578.688.482A10.001 10.001 0 0022 12c0-5.523-4.477-10-10-10z" clip-rule="evenodd" /></svg>
                </a>
                <a href="https://www.linkedin.com/in/rajatkumar7/" target="_blank" rel="noopener noreferrer" class="text-gray-400 hover:text-white transition-colors">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24" aria-hidden="true"><path d="M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"/></svg>
                </a>
            </div>
            <p>Made with ❤️ by Rajat Kumar</p>
            <p class="text-xs opacity-70">Copyright © 2025 Rajat Kumar. All Rights Reserved.</p>
        </footer>

    </div>
    
    <div id="modal" class="modal-overlay">
        <div class="modal-content panel p-8 text-center space-y-6">
            <p id="modal-message" class="text-4xl font-bold tracking-tight"></p>
            <button id="restart-game-btn" class="btn w-full">Play Again</button>
        </div>
    </div>

    <script>
    document.addEventListener('DOMContentLoaded', () => {
        const gameBoard = document.getElementById('game-board');
        const winCanvas = document.getElementById('win-canvas');
        const ctx = winCanvas.getContext('2d');
        const scoreX = document.getElementById('score-x');
        const scoreO = document.getElementById('score-o');
        const scoreDrawValue = document.getElementById('score-draw-value');
        const modal = document.getElementById('modal');
        const modalMessage = document.getElementById('modal-message');
        const restartGameBtn = document.getElementById('restart-game-btn');
        const difficultySlider = document.getElementById('difficulty-slider');
        const difficultyLabel = document.getElementById('difficulty-label');

        const xIcon = `<svg viewBox="0 0 128 128" style="stroke: #60a5fa; fill: none; stroke-width: 12; stroke-linecap: round;"><line x1="16" y1="16" x2="112" y2="112"></line><line x1="112" y1="16" x2="16" y2="112"></line></svg>`;
        const oIcon = `<svg viewBox="0 0 128 128" style="stroke: #f472b6; fill: none; stroke-width: 12; stroke-linecap: round;"><circle cx="64" cy="64" r="48"></circle></svg>`;
        
        const state = {
            board: Array(9).fill(null),
            currentPlayer: 'X',
            isGameActive: true,
            difficulty: 3,
            scores: { X: 0, O: 0, D: 0 }
        };
        const winningCombinations = [[0, 1, 2], [3, 4, 5], [6, 7, 8], [0, 3, 6], [1, 4, 7], [2, 5, 8], [0, 4, 8], [2, 4, 6]];
        const difficultyNames = ["", "Easy", "Medium", "Normal", "Hard", "Unbeatable"];

        restartGameBtn.addEventListener('click', resetBoard);
        difficultySlider.addEventListener('input', handleDifficultyChange);

        function resetBoard() {
            state.board.fill(null);
            state.isGameActive = true;
            state.currentPlayer = 'X';
            
            gameBoard.innerHTML = '';
            for (let i = 0; i < 9; i++) {
                const cell = document.createElement('div');
                cell.classList.add('cell');
                cell.dataset.index = i;
                cell.style.opacity = '0';
                cell.style.animation = `fade-in-up 0.5s ${i * 0.05}s ease-out forwards`;
                cell.addEventListener('click', handleCellClick);
                gameBoard.appendChild(cell);
            }
            
            clearCanvas();
            updateActivePlayerUI();
            hideModal();
        }

        function handleCellClick(event) {
            if (!state.isGameActive || state.currentPlayer === 'O') return;
            const cell = event.currentTarget;
            const cellIndex = parseInt(cell.dataset.index);

            if (state.board[cellIndex]) return;

            makeMove(cellIndex, 'X');
            cell.removeEventListener('click', handleCellClick);


            if (state.isGameActive) {
                gameBoard.style.pointerEvents = 'none';
                setTimeout(() => {
                    aiMove();
                    gameBoard.style.pointerEvents = 'auto';
                }, 600);
            }
        }

        function makeMove(index, player) {
            if (!state.isGameActive) return;
            state.board[index] = player;
            const cell = document.querySelector(`.cell[data-index='${index}']`);
            cell.innerHTML = player === 'X' ? xIcon : oIcon;
            cell.classList.add(player.toLowerCase());
            
            if (checkWin(player)) {
                endGame(false);
            } else if (isDraw()) {
                endGame(true);
            } else {
                state.currentPlayer = state.currentPlayer === 'X' ? 'O' : 'X';
                updateActivePlayerUI();
            }
        }

        function endGame(isDraw) {
            state.isGameActive = false;
            let message = '';
            if (isDraw) {
                state.scores.D++;
                message = "It's a Draw!";
            } else {
                state.scores[state.currentPlayer]++;
                message = state.currentPlayer === 'X' ? 'You Win!' : 'AI Wins!';
            }
            updateScoreDisplay();
            setTimeout(() => showModal(message), 700);
        }

        function aiMove() {
            if (!state.isGameActive) return;
            let move;
            const availableMoves = state.board.map((v, i) => v === null ? i : null).filter(v => v !== null);

            if (state.difficulty == 1) { // Completely Random
                move = availableMoves[Math.floor(Math.random() * availableMoves.length)];
            } 
            else if (state.difficulty == 2) { // 50% chance to block, else random
                let blockingMove = findWinningOrBlockingMove('X');
                if (blockingMove !== null && Math.random() > 0.5) {
                    move = blockingMove;
                } else {
                     move = availableMoves[Math.floor(Math.random() * availableMoves.length)];
                }
            }
            else if (state.difficulty == 3) { // Standard logic (Win > Block > Center > Corner > Random)
                let winningMove = findWinningOrBlockingMove('O');
                let blockingMove = findWinningOrBlockingMove('X');
                const corners = [0, 2, 6, 8].filter(i => state.board[i] === null);

                if (winningMove !== null) move = winningMove;
                else if (blockingMove !== null) move = blockingMove;
                else if (state.board[4] === null) move = 4;
                else if (corners.length > 0) move = corners[Math.floor(Math.random() * corners.length)];
                else move = availableMoves[0];
            }
            else { // Unbeatable Minimax
                move = minimax(state.board, 'O').index;
            }
            
            const cell = document.querySelector(`.cell[data-index='${move}']`);
            cell.removeEventListener('click', handleCellClick);
            makeMove(move, 'O');
        }
        
        function findWinningOrBlockingMove(player) {
            for (const combination of winningCombinations) {
                const [a, b, c] = combination;
                if (state.board[a] === player && state.board[b] === player && state.board[c] === null) return c;
                if (state.board[a] === player && state.board[c] === player && state.board[b] === null) return b;
                if (state.board[b] === player && state.board[c] === player && state.board[a] === null) return a;
            }
            return null;
        }

        function minimax(newBoard, player) {
            const availSpots = newBoard.map((v, i) => v === null ? i : null).filter(v => v !== null);

            if (checkWinOnBoard(newBoard, 'X')) return { score: -10 };
            if (checkWinOnBoard(newBoard, 'O')) return { score: 10 };
            if (availSpots.length === 0) return { score: 0 };

            const moves = [];
            for (let i = 0; i < availSpots.length; i++) {
                const move = {};
                move.index = availSpots[i];
                newBoard[availSpots[i]] = player;

                if (player === 'O') {
                    const result = minimax(newBoard, 'X');
                    move.score = result.score;
                } else {
                    const result = minimax(newBoard, 'O');
                    move.score = result.score;
                }
                newBoard[availSpots[i]] = null;
                moves.push(move);
            }

            let bestMove;
            if (player === 'O') {
                let bestScore = -10000;
                for (let i = 0; i < moves.length; i++) {
                    if (moves[i].score > bestScore) {
                        bestScore = moves[i].score;
                        bestMove = i;
                    }
                }
            } else {
                let bestScore = 10000;
                for (let i = 0; i < moves.length; i++) {
                    if (moves[i].score < bestScore) {
                        bestScore = moves[i].score;
                        bestMove = i;
                    }
                }
            }
            return moves[bestMove];
        }

        function checkWin(player) {
            const winCombo = winningCombinations.find(combo => combo.every(index => state.board[index] === player));
            if (winCombo) {
                drawWinningLine(winCombo);
                return true;
            }
            return false;
        }

        function checkWinOnBoard(board, player) {
            return winningCombinations.some(combination => combination.every(index => board[index] === player));
        }

        function isDraw() {
            return state.board.every(cell => cell !== null);
        }
        
        function drawWinningLine(combination) {
            const cells = Array.from(document.querySelectorAll('.cell'));
            const startCell = cells[combination[0]].getBoundingClientRect();
            const endCell = cells[combination[2]].getBoundingClientRect();
            const boardRect = gameBoard.getBoundingClientRect();
            
            const startX = startCell.left + startCell.width / 2 - boardRect.left;
            const startY = startCell.top + startCell.height / 2 - boardRect.top;
            const endX = endCell.left + endCell.width / 2 - boardRect.left;
            const endY = endCell.top + endCell.height / 2 - boardRect.top;
            
            winCanvas.width = boardRect.width;
            winCanvas.height = boardRect.height;
            
            const winner = state.currentPlayer;
            ctx.strokeStyle = winner === 'X' ? '#60a5fa' : '#f472b6';
            ctx.shadowColor = winner === 'X' ? '#60a5fa' : '#f472b6';
            ctx.lineWidth = 10;
            ctx.lineCap = 'round';
            ctx.shadowBlur = 15;

            let progress = 0;
            function animateLine() {
                if (progress >= 1) return;
                progress += 0.04;
                ctx.clearRect(0, 0, winCanvas.width, winCanvas.height);
                ctx.beginPath();
                ctx.moveTo(startX, startY);
                ctx.lineTo(startX + (endX - startX) * progress, startY + (endY - startY) * progress);
                ctx.stroke();
                requestAnimationFrame(animateLine);
            }
            animateLine();
        }
        
        function clearCanvas() {
            ctx.clearRect(0, 0, winCanvas.width, winCanvas.height);
        }

        function updateScoreDisplay() {
            document.getElementById('score-x-value').textContent = state.scores.X;
            document.getElementById('score-o-value').textContent = state.scores.O;
            scoreDrawValue.textContent = state.scores.D;
        }
        
        function updateActivePlayerUI() {
            scoreX.classList.toggle('active', state.currentPlayer === 'X');
            scoreO.classList.toggle('active', state.currentPlayer === 'O');
        }

        function handleDifficultyChange(event) {
            state.difficulty = parseInt(event.target.value, 10);
            difficultyLabel.textContent = `Difficulty: ${difficultyNames[state.difficulty]}`;
            state.scores = { X: 0, O: 0, D: 0 };
            updateScoreDisplay();
            resetBoard();
        }

        function showModal(message) {
            modalMessage.textContent = message;
            modal.classList.add('active');
        }

        function hideModal() {
            modal.classList.remove('active');
        }

        resetBoard();
    });
    </script>
</body>
</html>


